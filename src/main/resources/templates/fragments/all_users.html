<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <title>Все пользователи</title>
</head>
<body>
<!-- Для отображения одного или нескольких пользователей -->
<!-- В зависимости от адреса запроса и ролей может внешне отличаться -->
<table th:fragment="allUsers(users)" class="table table-striped table-sm p-3">
    <thead>
    <tr>
        <th>ID</th>
        <th>Имя</th>
        <th>Фамилия</th>
        <th>Возраст</th>
        <th>Почта</th>
        <th>Роли</th>
        <th colspan="2" sec:authorize="hasRole('ADMIN')"
            th:if="${#httpServletRequest.getRequestURI().endsWith('/admin')}">
            Действия
        </th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="u, it : ${users}">
        <td class="col-1" th:text="${u.id}"></td>
        <td class="col-2 text-nowrap" th:text="${u.firstName}"></td>
        <td class="col-2 text-nowrap" th:text="${u.lastName}"></td>
        <td class="col-1" th:text="${u.age}"></td>
        <td class="col2 text-nowrap" th:text="${u.username}"></td>
        <td class="col-sm-2 col-xl-1 text-nowrap" th:text="${u.rolesAsText()}"></td>
        <td class="col-1" sec:authorize="hasRole('ADMIN')"
            th:if="${#httpServletRequest.getRequestURI().endsWith('/admin')}">
            <a type="button" class="btn btn-sm btn-info text-light" data-bs-toggle="modal"
               th:data-bs-target="${'#editModal'+u.id}">Edit</a>
        </td>
        <td class="col-1" sec:authorize="hasRole('ADMIN')"
            th:if="${#httpServletRequest.getRequestURI().endsWith('/admin')}">
            <a type="button" class="btn btn-sm btn-danger" data-bs-toggle="modal"
               data-bs-target="#deleteModal" th:data-bs-target="${'#deleteModal'+u.id}">Delete</a>
        </td>

        <th:block th:insert="~{fragments/modal :: edit(u = ${u})}"></th:block>
        <th:block th:insert="~{fragments/modal :: delete(u = ${u})}"></th:block>
    </tr>
    </tbody>
</table>

</body>
</html>